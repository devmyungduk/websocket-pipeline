[English](./README.en.md) | [í•œêµ­ì–´](./README.md)

# ðŸªŸ Windows WebSocket Pipeline Guide

> **Next.js â†’ Node.js â†’ TouchDesigner**  
> Windows 10/11 | Beginner-Friendly | November 2025

---

## âœ… Prerequisites

```
â–¡ Windows 10 or higher
â–¡ Node.js 20.x or higher required
â–¡ TouchDesigner 2023.10+ required
```

---

## ðŸ“¥ 1. Download Project

### Method 1: Git Clone (Recommended)
```cmd
C:\> git clone https://github.com/devmyungduk/websocket-pipeline.git
C:\> cd websocket-pipeline
```

### Method 2: ZIP Download
1. Visit https://github.com/devmyungduk/websocket-pipeline
2. Click green 'Code' button
3. Select 'Download ZIP'
4. Extract to `C:\websocket-pipeline\`

---

## ðŸ”§ 2. Node.js Installation (One-time Setup)

### 2.1 Download
- Visit https://nodejs.org
- Download "20.x LTS (Recommended)"

### 2.2 Verify Installation
```cmd
C:\> node --version
v22.11.0

C:\> npm --version
10.8.2
```

---

## ðŸ“¦ 3. Package Installation

### 3.1 WebSocket Server

**Open CMD â†’ Navigate to server folder**

```cmd
C:\> cd websocket-pipeline\server
C:\websocket-pipeline\server> npm install
```

**Success output:**
```
added 1 package, and audited 2 packages in 2s
found 0 vulnerabilities
```

### 3.2 Next.js Client

**Open new CMD â†’ Navigate to client folder**

```cmd
C:\> cd websocket-pipeline\client
C:\websocket-pipeline\client> npm install
```

**Success output:**
```
added XXX packages in XXs
```

---

## ðŸš€ 4. Execution Order

### âœ… Pre-execution Checklist

```
â–¡ Node.js installed
â–¡ npm install completed in server folder
â–¡ npm install completed in client folder
```

---

### 4.1 Start WebSocket Server [CMD #1]

**Location:** `C:\websocket-pipeline\server`

```cmd
C:\websocket-pipeline\server> node server.js
```

**Success output:**
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
WebSocket Server Started
Address: ws://localhost:8080
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

> âš ï¸ **Keep this window open!** Server must continue running.

---

### 4.2 Start Next.js Client [CMD #2]

**Open new CMD window**

**Location:** `C:\websocket-pipeline\client`

```cmd
C:\websocket-pipeline\client> npm run dev
```

**Success output:**
```
  â–² Next.js 16.0.1 (Turbopack)
  - Local:        http://localhost:3000
  - Network:      http://172.30.1.79:3000

 âœ“ Starting...
 âœ“ Ready in 2s
```

---

### 4.3 Browser Testing

1. **Open browser:** http://localhost:3000
2. **Check connection:** Green "Connected" indicator in top-right
3. **Test:**
   - Click screen â†’ Check transmission log
   - Keyboard input â†’ Check transmission log

**Client Interface:**

<img src="./images/client-screenshot.png" width="800">

---

## ðŸŽ¨ 5. TouchDesigner Connection

### 5.1 Add WebSocket DAT

1. Launch TouchDesigner
2. Right-click empty space
3. **Add Operator â†’ DAT â†’ WebSocket**

### 5.2 Parameters Configuration

| Parameter | Value |
|-----------|-------|
| **Active** | âœ… ON |
| **Network Address** | `localhost` |
| **Network Port** | `8080` |
| **Auto Reconnect** | âœ… ON |

> âš ï¸ **Important:** Do NOT include `ws://` or port number in Network Address!
> 
> âŒ Wrong: `ws://localhost:8080`  
> âœ… Correct: `localhost` (enter port separately)

### 5.3 Data Verification

**Double-click WebSocket DAT:**

```json
{"type":"click","x":512,"y":384,"time":"15:30:45"}
{"type":"keydown","key":"a","time":"15:30:50"}
```

---

## ðŸ“‚ Project Structure

```
C:\websocket-pipeline\
â”‚
â”œâ”€â”€ ðŸ“„ .gitignore              â† Git exclusions
â”œâ”€â”€ ðŸ“„ README.md               â† Korean guide
â”œâ”€â”€ ðŸ“„ README.en.md            â† This file
â”‚
â”œâ”€â”€ ðŸ“ server\                 â† WebSocket Server
â”‚   â”œâ”€â”€ ðŸ“„ server.js
â”‚   â”œâ”€â”€ ðŸ“„ package.json
â”‚   â””â”€â”€ ðŸ“ node_modules\       â† Auto-generated by npm install
â”‚
â””â”€â”€ ðŸ“ client\                 â† Next.js Client (TypeScript)
    â”œâ”€â”€ ðŸ“ .next\              â† Auto-generated by npm run dev
    â”œâ”€â”€ ðŸ“ app\
    â”‚   â”œâ”€â”€ ðŸ“„ page.tsx        â† WebSocket sender code
    â”‚   â”œâ”€â”€ ðŸ“„ layout.tsx
    â”‚   â”œâ”€â”€ ðŸ“„ globals.css
    â”‚   â””â”€â”€ ðŸ“„ favicon.ico
    â”‚
    â”œâ”€â”€ ðŸ“ node_modules\       â† Auto-generated by npm install
    â”œâ”€â”€ ðŸ“ public\
    â”‚   â””â”€â”€ *.svg
    â”‚
    â”œâ”€â”€ ðŸ“„ .gitignore
    â”œâ”€â”€ ðŸ“„ eslint.config.mjs
    â”œâ”€â”€ ðŸ“„ next.config.ts
    â”œâ”€â”€ ðŸ“„ next-env.d.ts       â† Auto-generated by Next.js
    â”œâ”€â”€ ðŸ“„ package.json
    â”œâ”€â”€ ðŸ“„ postcss.config.mjs
    â””â”€â”€ ðŸ“„ tsconfig.json
```

**Key Code Files:**
- [`server/server.js`](./server/server.js) - WebSocket Server
- [`client/app/page.tsx`](./client/app/page.tsx) - Next.js Client

---

## âŒ Troubleshooting

### "Cannot find module 'ws'"

**Cause:** npm install not executed in server folder

**Solution:**
```cmd
C:\websocket-pipeline\server> npm install
```

---

### "EADDRINUSE" (Port in Use)

**Solution 1: Kill existing process**
```cmd
C:\> netstat -ano | findstr :8080
  TCP    0.0.0.0:8080    LISTENING    1234

C:\> taskkill /PID 1234 /F
```

**Solution 2: Use different port**
1. Edit `server/server.js`:
   ```javascript
   const server = new WebSocket.Server({ port: 8081 });
   ```
2. Edit `client/app/page.tsx`:
   ```javascript
   new WebSocket('ws://localhost:8081');
   ```
3. Update TouchDesigner port: `8081`

---

### TouchDesigner Connection Failed

**Checklist:**
```
â–¡ [CMD #1] server.js running?
â–¡ Active parameter ON?
â–¡ Network Address: localhost (without ws://)
â–¡ Network Port: 8080
â–¡ Firewall blocking?
```

**Firewall exemption (Admin CMD):**
```cmd
netsh advfirewall firewall add rule name="WebSocket" dir=in action=allow protocol=TCP localport=8080
```

---

## ðŸ”„ Execution Flow

```
[CMD #1] node server.js
    â†“
WebSocket Server Started (Port 8080)
    â†“
[CMD #2] npm run dev
    â†“
Next.js Started (Port 3000)
    â†“
Browser: http://localhost:3000
    â†“
Click/Key Input â†’ WebSocket Transmission
    â†“
TouchDesigner: Receive via WebSocket DAT
```

---

## ðŸ›‘ Shutdown

1. **Close browser**
2. **[CMD #2]** `Ctrl + C` (Stop Next.js)
3. **[CMD #1]** `Ctrl + C` (Stop server)

---

## ðŸ“š Additional Resources

| Item | URL |
| --- | --- |
| Node.js | https://nodejs.org/docs |
| Next.js | https://nextjs.org/docs |
| TouchDesigner | https://docs.derivative.ca |
| WebSocket (ws) | https://www.npmjs.com/package/ws |
| TypeScript | https://www.typescriptlang.org/docs |

---

## âœ… Quick Start Summary

```cmd
# 1. Download project
git clone https://github.com/devmyungduk/websocket-pipeline.git
cd websocket-pipeline

# 2. Install packages
cd server
npm install
cd ..\client
npm install

# 3. Execute
# CMD #1
cd ..\server
node server.js

# CMD #2 (new window)
cd websocket-pipeline\client
npm run dev

# 4. Browser: http://localhost:3000
# 5. TouchDesigner: Configure WebSocket DAT
```

---

**Written:** November 2025  
**Environment:** Verified on Windows 10/11  
**Tech Stack:** Node.js + Next.js 16 (TypeScript) + TouchDesigner  
**Last Updated:** 2025-11-05 (Improved project structure)
